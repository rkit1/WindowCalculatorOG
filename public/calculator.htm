<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">

    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">

    <link type="text/css" href="head.css" rel="stylesheet">

    <title></title>
</head>
<body xmlns:ng="http://angularjs.org" id="ng-app" ng-app="Calc">
<div class="head-bg">
    <div class="head">
        <h2 class="logo"><a href="/">Окна Горизонт</a></h2>
        <div class="slogan"><span>Москва, Ореховый проезд, 11</span><br>(495) 645-90-75</div>
        <ul class="icons">
            <li class="home"><a href="/"></a></li>
            <li class="sitemap"><a href="sections/zamerr"></a></li>
            <li class="mail"><a href="sections/kontakt"></a></li>
        </ul>
        <ul class="menu menutop">
            <li><a href="sections/plastikokna">Окна</a></li>
            <li><a href="sections/osteklenie">Балконы</a></li>
            <li><a href="sections/osteklenieceni">Цены на балконы </a></li>
            <li><a href="sections/cena_dom">Цены на окна</a></li>
            <li><a href="sections/stati">Полезные статьи</a></li>
            <li class="last"><a href="sections/kontakt">Контакты</a></li>
        </ul>
    </div>
</div>
<div ng-controller="CalcController" class="container" id="ctrl">
    <div>
        <div class="row">
            <div class="span8">
                <ul class="nav nav-tabs">
                    <li ng-repeat="window in windows"
                        ng-class="{active: window == currentWindow}">
                        <div class="addRemove"><a class="text-error" ng-click="removeWindowConfirm(window)">
                            <i class="icon-remove"></i> Удалить</a></div>
                        <a ng-click="selectWindow($index)">
                            <div class="thumbImage">
                                <div ng-show="window.type == 'door'"
                                     class="doorThumbImage"></div>
                                <div ng-repeat="pane in window.getActivePanes()"
                                     class="paneThumbType"
                                     ng-class="{solid: 'paneThumbTypeSolid', rot: 'paneThumbTypeRot', rotdrop: 'paneThumbTypeRotdrop'}[pane.type]"
                                ></div>
                            </div>
                            <div ng-hide="window.$$errors.hasSome">
                                {{window.getSinglePrice() | rub}}
                                <span ng-show="window.quantity > 1">x {{window.quantity}} = {{window.getTotalPrice() | rub}}</span>
                            </div>
                            <div ng-show="window.$$errors.hasSome" class="text-error">
                                Заполнено неверно.
                            </div>
                        </a>
                    </li>
                    <li>
                        <div class="addRemove">
                            <a ng-click="newWindow()" class="text-success"><i class="icon-plus-sign"></i> Добавить</a>
                        </div>
                    </li>
                </ul>

                    <div class="span8">
                        <div id="productTypeSelector">
                                Тип:
                                <div class="item">
                                    <a ng-click="currentWindow.setType('1p')"
                                       ng-class="{'selected':true}[currentWindow.type=='1p']"
                                            ><img alt="Одностворчатое окно"
                                                  title="Одностворчатое окно"
                                                  src="img/window1Pthumb.png"></a>
                                </div>
                                <div class="item">
                                    <a ng-click="currentWindow.setType('2p')"
                                       ng-disabled="currentWindow.type=='2p'"
                                            ><img alt="Двустворчатое окно"
                                                  title="Двуостворчатое окно"
                                                  src="img/window2Pthumb.png"></a>
                                </div>
                                <div class="item">
                                    <a ng-click="currentWindow.setType('3p')"
                                       ng-disabled="currentWindow.type=='3p'"
                                            ><img alt="Трехстворчатое окно"
                                                  title="Трехстворчатое окно"
                                                  src="img/window3Pthumb.png"></a>
                                </div>
                                <div class="item">
                                    <a ng-click="currentWindow.setType('door')"
                                       ng-disabled="currentWindow.type=='door'"
                                            ><img alt="Балконная дверь"
                                                  title="Балконная дверь"
                                                  src="img/doorthumb.png"></a>
                                </div>
                            </div>
                        <br>
                        <!-- Изображение окна -->
                            <table id="fullWindowImage" ng-show="{'1p': true,'2p': true,'3p': true}[currentWindow.type]">
                                <tr>
                                    <td colspan="2"></td>
                                    <td colspan="{{currentWindow.getActivePanes().length}}"
                                        class="widthSelector-input">
                                        <input type="number" class="dimension" ng-model="currentWindow.width"
                                               ng-change="currentWindow.recalculateWidth()"
                                               ng-class="{myError:currentWindow.$$errors.errors.paneWindowWidthMismatch}">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2"></td>
                                    <td colspan="{{currentWindow.getActivePanes().length}}"
                                        class="windowWidthSelector"
                                        ng-class="{true:'myError'}[currentWindow.$$errors.widthError]">
                                    </td>
                                </tr>
                                <tr>
                                    <td class="heightSelector-input">
                                        <input type="number" class="dimension"
                                               ng-model="currentWindow.height"></td>
                                    <td class="windowHeightSelector"></td>
                                    <td ng-repeat="pane in currentWindow.getActivePanes()"
                                        title="{{{solid: 'Глухая створка', rot: 'Поворотная створка', rotdrop: 'Поворотно-откидная створка'}[pane.type]}}"
                                        class="paneType {{paneClassHelper(pane)}}" ng-click="paneTypeSelector.open(pane)">

                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2"></td>
                                    <td ng-repeat="pane in currentWindow.getActivePanes()" class="paneWidthSelector">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2"></td>
                                    <td ng-repeat="pane in currentWindow.getActivePanes()" class="widthSelector-input">
                                        <input type="number" class="dimension" ng-model="pane.width" ng-readonly="$last"
                                               ng-change="currentWindow.recalculateWidth()"
                                               ng-class="{true:'myError'}[currentWindow.$$errors.paneErrors[$index]]">
                                    </td>
                                <tr>
                                    <td colspan="2"></td>
                                    <td ng-repeat="pane in currentWindow.getActivePanes()"  class="panesAccessories">
                                        <div ng-show="pane.type=='rot' || pane.type=='rotdrop'" style="text-align: center">
                                            <!--<label><input type="checkbox" ng-model="pane.key"> ручка с ключом</label>-->
                                            <label><input type="checkbox" ng-model="pane.net"> москитная сетка</label>
                                        </div>
                                    </td>
                                </tr>
                            </table>


                            <!-- Изображение двери -->
                            <table ng-show="currentWindow.type == 'door'">
                                <tr>
                                    <td colspan="2"></td>
                                    <td class="widthSelector-input">
                                        <input type="number" class="dimension" ng-model="currentWindow.width">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2"></td>
                                    <td class="doorWidthSelector"></td>
                                </tr>
                                <tr>
                                    <td class="heightSelector-input">
                                        <input type="number" class="dimension"
                                               ng-model="currentWindow.height">
                                    </td>
                                    <td class="doorHeightSelector"></td>
                                    <td class="doorImage"></td>
                                </tr>
                            </table>


                            <div class="text-info"
                                >Все размеры указываются в миллиметрах</div>
                            <div class="text-info"
                                >Нажмите по створке для изменения типа</div>
                            <div class="text-error"
                                 ng-show="currentWindow.$$errors.errors.paneTooSmall"
                                    >Ширина створки должна быть не меньше 100мм.</div>
                            <div class="text-error"
                                 ng-show="currentWindow.$$errors.errors.paneWindowWidthMismatch"
                                    >Общая ширина створок больше ширины окна</div>


                        <br>





                        <table>
                            <tr>
                                <td class="form-label">
                                    <label for="profile">Профиль</label>
                                </td>
                                <td>
                                    <!-- FIXME расценка -->
                                    <select ng-model="currentWindow.profile" id="profile">
                                        <option value="0">Montblank</option>
                                        <option value="1">Rehau</option>
                                        <option value="2">Veka</option>
                                    </select>
                                </td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td class="form-label">
                                    <label for="steklopaket">Стеклопакет</label>
                                </td>
                                <td>
                                    <select ng-model="currentWindow.steklopaket" id="steklopaket">
                                        <option value="1">Однокамерный</option>
                                        <option value="2">Двухкамерный</option>
                                    </select>
                                </td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr ng-show="currentWindow.isActuallyWindow()">
                                <td class="form-label">
                                    <label for="podokonniki">Подоконник</label>
                                </td>
                                <td>
                                    <!-- FIXME -->
                                    <select ng-model="currentWindow.podokonniki.type" id="podokonniki">
                                        <option value="-1">Не нужен</option>
                                        <option value="0">100мм</option>
                                        <option value="1">150мм</option>
                                        <option value="2">200мм</option>
                                        <option value="3">250мм</option>
                                        <option value="4">300мм</option>
                                        <option value="5">350мм</option>
                                        <option value="6">400мм</option>
                                        <option value="7">450мм</option>
                                        <option value="8">500мм</option>
                                        <option value="9">550мм</option>
                                        <option value="10">600мм</option>
                                    </select>
                                </td>
                                <td>{{getPodokonnikPrice(currentWindow) | rub}}</td>
                            </tr>
                            <tr ng-show="currentWindow.isActuallyWindow()">
                                <td class="form-label">
                                    <label for="otlivy">Отлив</label>
                                </td>
                                <td>
                                    <select ng-model="currentWindow.otlivy.type" id="otlivy">
                                        <option value="-1">Не нужен</option>
                                        <option value="0">0-110мм</option>
                                        <option value="1">110-150мм</option>
                                        <option value="2">151-180мм</option>
                                        <option value="3">181-200мм</option>
                                        <option value="4">201-206мм</option>
                                        <option value="5">261-280мм</option>
                                        <option value="6">281-310мм</option>
                                        <option value="7">311-340мм</option>
                                        <option value="8">341-420мм</option>
                                    </select>
                                </td>
                                <td>{{getOtlivPrice(currentWindow) | rub}}</td>
                            </tr>
                            <tr>
                                <td class="form-label">
                                    <label for="laminate">Ламинация</label>
                                </td>
                                <td>
                                    <select ng-model="currentWindow.laminate" id="laminate">
                                        <option value="0">нет</option>
                                        <option value="1">односторонняя</option>
                                        <option value="2">двусторонняя</option>
                                    </select>
                                </td>
                                <td>&nbsp;</td>
                            </tr>
                        </table>


                        <!--
                        <label>Количество
                            <input type="number" class="input-mini"
                                   min="1"
                                   ng-model="currentWindow.quantity"><br>
                        </label>

                        <div>
                            <button class="btn btn-danger"
                                    ng-click="removeWindowConfirm(currentWindow)"><i class="icon-trash"></i> Удалить изделие</button>
                        </div>
                        -->
                </div>
            </div>


            <div class="span4">
                <div class="span4" data-spy="affix" data-offset-top="268">
                    <div ng-hide="hasErrors()">
                        <h4>Окна и двери: {{getTotalWindowsPrice() | rub}}</h4>
                        <h4>Аксессуары: {{getAccessoryPrice() | rub}}</h4>
                        <h4>Подоконники и отливы: {{getPodokonnikyOtlivyPrice() | rub}}</h4>
                        <h4>Работы (монтаж, доставка): {{getWorksPrice() | rub}}</h4>
                        <h4>Скидка: -{{getDiscount() | rub}}</h4>
                        <h3>Общая сумма: {{getTotalPrice() | rub}}</h3>
                        <button class="btn btn-large btn-primary" style="width: 100%;">Заказ</button>
                    </div>
                    <div class="text-error" ng-show="hasErrors()">
                        Для рассчета исправьте ошибки.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div modal="confirm.isOpen" close="confirm.close()" options="confirm.options">
        <div class="modal-header">{{confirm.message}}</div>
        <div class="modal-footer">
            <button class="btn btn-warning" ng-click="confirm.confirm()">Да</button>
            <button class="btn btn-primary cancel" ng-click="confirm.close()">Нет</button>
        </div>
    </div>
    <div modal="paneTypeSelector.isOpen" close="paneTypeSelector.close()" options="paneTypeSelector.options">
        <div class="modal-header">
            <h4>Тип створки:
                {{{solid: 'глухая', rot: 'поворотная', rotdrop: 'поворотно-откидная'}[paneTypeSelector.hoverType]}}</h4>
        </div>
        <div class="modal-body">
            <ul class="thumbnails">
                <li>
                    <a class="thumbnail" ng-click="paneTypeSelector.select('solid')"
                       ng-mouseover="paneTypeSelector.hover('solid')">
                        <img src="img/paneSolid_h240.png" alt="Глухая створка">
                    </a>
                </li>
                <li>
                    <a class="thumbnail"  ng-click="paneTypeSelector.select('rot','left')"
                       ng-mouseover="paneTypeSelector.hover('rot')">
                        <img src="img/paneRotL_h240.png" alt="Поворотная створка">
                    </a>
                </li>
                <li>
                    <a class="thumbnail"  ng-click="paneTypeSelector.select('rot','right')"
                       ng-mouseover="paneTypeSelector.hover('rot')">
                        <img src="img/paneRotR_h240.png" alt="Поворотная створка">
                    </a>
                </li>
                <li>
                    <a class="thumbnail"  ng-click="paneTypeSelector.select('rotdrop','left')"
                       ng-mouseover="paneTypeSelector.hover('rotdrop')">
                        <img src="img/paneRotDropL_h240.png" alt="Поворотно-откидная створка">
                    </a>
                </li>
                <li>
                    <a class="thumbnail"  ng-click="paneTypeSelector.select('rotdrop','right')"
                       ng-mouseover="paneTypeSelector.hover('rotdrop')">
                        <img src="img/paneRotDropR_h240.png" alt="Поворотно-откидная створка">
                    </a>
                </li>
            </ul>
        </div>
        <div class="modal-footer">
            <button class="btn btn-warning cancel" ng-click="paneTypeSelector.close()"
                    >Отмена</button>
        </div>
    </div>
    <!--
    <pre>
    {{stateHelper()}}
        </pre>-->
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular-cookies.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular-resource.min.js"></script>
<script src="jsdeps/ui-bootstrap-tpls-0.3.0.min.js"></script>
<script src="controller.js"></script>
</body>
</html>